---
import { DEFAULT_LOCALE } from "@blitzkit/i18n";
import strings from "@blitzkit/i18n/strings/en.json";
import "@fontsource/inter";
import { Flex } from "@radix-ui/themes";
import Analytics from "../components/Analytics.astro";
import { BlitzKitTheme } from "../components/BlitzKitTheme";
import { Checks } from "../components/Checks";
import Footer from "../components/Footer.astro";
import LocaleRedirector from "../components/LocaleRedirector.astro";
import Meta from "../components/Meta.astro";
import Navbar from "../components/Navbar.astro";
import PWA from "../components/PWA.astro";
import Servicing from "../components/Servicing.astro";
import "./base.css";

export interface Props {
  noFooter?: boolean;
  noNavbar?: boolean;
  integrated?: boolean;
}

const servicing = import.meta.env.SERVICING;
const { noFooter, noNavbar, integrated } = Astro.props;
const locale = Astro.params.locale ?? DEFAULT_LOCALE;
---

<html lang={locale}>
  <head>
    <meta property="og:site_name" content={strings.common.name} />

    <PWA />
    <Meta />
    <Analytics />
    <LocaleRedirector />

    <slot name="head" />
  </head>

  <body class={noNavbar ? "no-navbar" : ""}>
    <BlitzKitTheme>
      <Flex direction="column" minHeight="100vh">
        <Navbar {integrated} />

        <Checks {locale} client:only="react" />

        {servicing ? <Servicing /> : <slot />}

        {!noFooter && <Footer />}
      </Flex>
    </BlitzKitTheme>
  </body>
</html>
