---
import { AstroSeo } from '@astrolib/seo';
import { assertSecret } from '@blitzkit/core';
import { DEFAULT_LOCALE, STRINGS, type SupportedLocale } from '@blitzkit/i18n';
import locales from '@blitzkit/i18n/locales.json';
import { literals } from '@blitzkit/i18n/src/literals';
import { Box, Flex, Heading, Link } from '@radix-ui/themes';
import type { GetStaticPaths } from 'astro';
import { AesonPlug } from '../../components/AesonPlug';
import HomeHero from '../../components/HomeHero.astro';
import { Plugs } from '../../components/Plugs';
import ToolCard from '../../components/ToolCard.astro';
import {
  compareTool,
  discordTool,
  embedTool,
  galleryTool,
  moreTool,
  performanceTool,
  sessionTool,
  tankopediaTool,
  tierListTool,
} from '../../constants/tools';
import BaseLayout from '../../layouts/BaseLayout.astro';

const PUBLIC_ASSET_BRANCH = assertSecret(import.meta.env.PUBLIC_ASSET_BRANCH);
const { strings, locale } = Astro.props;

export const getStaticPaths = (() => {
  return locales.supported.map(({ locale, blitz }) => {
    return {
      params: { locale: locale === locales.default ? undefined : locale },

      props: {
        locale,
        strings: STRINGS[locale as SupportedLocale],
        blitzLocale: blitz ?? locale,
      },
    };
  });
}) satisfies GetStaticPaths;
---

<AstroSeo
  title="BlitzKit"
  description={strings.website.home.seo_description}
  canonical={Astro.url.href}
  openGraph={{
    url: Astro.url.href,
    title: 'BlitzKit',
    description: strings.website.home.seo_description,
    site_name: 'BlitzKit',
  }}
  twitter={{ cardType: 'summary_large_image' }}
/>

<BaseLayout {locale} {strings}>
  <HomeHero {locale} {strings} />

  <!-- <Flex justify="center" py="6" px="4" justify="center">
    <Flex
      wrap="wrap"
      justify="between"
      maxWidth="64rem"
      gap="6"
      align="center"
      flexGrow="1"
    >
      <HomeLocaleSwitcher {locale} client:load />
      <DiscordPlug {locale} client:only="react">
        <DiscordPlug {locale} skeleton slot="fallback" />
      </DiscordPlug>
    </Flex>
  </Flex> -->

  {
    locale !== DEFAULT_LOCALE && (
      <Flex justify="center" mb="4">
        <Link
          href="https://crowdin.com/project/blitzkrieg"
          target="_blank"
          underline="always"
        >
          {literals(strings.website.home.help_translate, [
            'BlitzKit',
            strings.common.locales[
              locale as keyof typeof strings.common.locales
            ],
          ])}
        </Link>
      </Flex>
    )
  }

  <Plugs client:idle />

  {
    PUBLIC_ASSET_BRANCH === 'preview' && (
      <Flex justify="center" my="8" px="4">
        <AesonPlug />
      </Flex>
    )
  }

  <Flex p="4" justify="center" gap="4" mt="3">
    <Flex maxWidth="80rem" flexGrow="1" gap="4" direction="column">
      <ToolCard {locale} {strings} tool={tankopediaTool} />

      <Flex gap="4" direction={{ initial: 'column', sm: 'row' }}>
        {/* <ToolCard {locale} {strings} tool={playerStatsTool} /> */}
        <ToolCard {locale} {strings} tool={compareTool} />
        <ToolCard {locale} {strings} tool={performanceTool} />
      </Flex>

      <Flex gap="4" direction={{ initial: 'column', sm: 'row' }}>
        <!-- <ToolCard {locale} {strings} tool={chartsTool} /> -->
        <!-- <ToolCard {locale} {strings} tool={guessTool} /> -->
        <ToolCard {locale} {strings} tool={galleryTool} />
        <ToolCard {locale} {strings} tool={sessionTool} />
      </Flex>

      <Flex gap="4" direction={{ initial: 'column', sm: 'row' }}>
        <ToolCard {locale} {strings} tool={discordTool} />
        <ToolCard {locale} {strings} tool={tierListTool} />
      </Flex>

      <Flex gap="4" direction={{ initial: 'column', sm: 'row' }}>
        <ToolCard {locale} {strings} tool={embedTool} />
        <ToolCard {locale} {strings} tool={moreTool} />
      </Flex>

      <Flex gap="4" direction={{ initial: 'column', sm: 'row' }}>
        <Box flexGrow="1" />
      </Flex>

      <Heading align="center" mt="6"
        >{strings.website.home.other_projects.title}</Heading
      >

      <Flex gap="4" mb="6" direction={{ initial: 'column', sm: 'row' }}>
        <ToolCard
          {locale}
          {strings}
          tool={{
            button: { color: 'blue' },
            id: 'blitz-analysis',
            stringsId: 'blitz_analysis',
            href: 'https://blitzanalysiz.com/',
          }}
        />
        <ToolCard
          {locale}
          {strings}
          tool={{
            button: { color: 'purple', highContrast: true },
            id: 'blitz-insider',
            stringsId: 'blitz_insider',
            href: 'https://discord.gg/UjWf9eGgtR',
          }}
        />
      </Flex>
    </Flex>
  </Flex>

  <div style={{ flex: 1 }}></div>
</BaseLayout>
