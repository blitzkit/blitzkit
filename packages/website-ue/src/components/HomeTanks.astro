---
import { api } from "../core/api/dynamic";
import { tools } from "../core/tools/tools";
import { Heading } from "./Heading";
import { Scroller } from "./Scroller";
import { Section } from "./Section";
import { TankCard } from "./TankCard";
import ToolCard from "./ToolCard.astro";
import ToolsWrapper from "./ToolsWrapper.astro";

interface Props {
  locale: string;
}

const { locale } = Astro.props;

const strings = await api.strings(locale);
const popular = (await api.popularTanks()).tanks.slice(0, 8);

console.log(popular.length);
---

<style>
  .title {
    margin-bottom: var(--space-3);
  }

  .tanks {
    z-index: 1;

    .content {
      display: flex;

      gap: 2rem;
    }
  }
</style>

<Section>
  <Heading size="2" className="title">{strings.home.tanks}</Heading>

  <Scroller client:load className="tanks">
    <div class="content">
      {popular.map((tank) => <TankCard {...tank} />)}
    </div>
  </Scroller>

  <ToolCard gradient {locale} tool={tools.tanks} />

  <ToolsWrapper>
    <ToolCard {locale} tool={tools.compare} />
    <ToolCard {locale} tool={tools.performance} />
  </ToolsWrapper>
</Section>
